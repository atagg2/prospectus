# impoart packages
import FLOWMath as FM
import HDF5 as H5

# method of characeristics

z4 = [-1.6726403823177711 -2.9701327433628313
15.053763440860228 -2.7432967509330624
26.762246117084775 -2.599445184550808
51.85185185185186 -2.339390310950402
73.59617682198322 -2.0959415738890472
102.03106332138607 -1.852466404457555
148.86499402628436 -1.4927681035303073
204.06212664277146 -1.1606916293970246
259.25925925925907 -0.9060487835823263
297.72998805256884 -0.7510295408168663
334.52807646356064 -0.6347337203032319
399.7610513739543 -0.47407777460589307
470.01194743130225 -0.34658784533891573
543.6081242532853 -0.25227054059483356
622.2222222222222 -0.18558827882978646
761.0513739546001 -0.1020752053795162
849.7013142174436 -0.07407010921855361
680.7646356033453 -0.1411092079804619
965.1135005973716 -0.04595928357703949
1055.436081242533 -0.029009526226198012
1175.8661887694145 -0.0174717966610638
1304.6594982078852 -0.011432000084583116
1406.690561529271 0.000033040462673383786
1497.0131421744325 0.00038987745953145136]

z4_p = [-1.6726403823177702 -2.9590707964601766
13.381123058542407 -2.7930821200875435
28.434886499402676 -2.5939076030069463
45.161290322580655 -2.4223813450904514
70.25089605734776 -2.1844503652953553
95.34050179211482 -1.9797052262082233
138.82915173237745 -1.6753298759793194
172.28195937873343 -1.470551696429515
219.1158900836318 -1.2214728645288162
259.25925925925907 -1.0221992260602024
312.7837514934292 -0.7841559086920207
362.962962962963 -0.6014355420221822
414.8148148148149 -0.4629563548704283
521.8637992831542 -0.291073259957074
652.3297491039426 -0.16887641281018473
807.8853046594979 -0.09082823188589684
965.1135005973714 -0.057021230479695095
1073.8351254480283 -0.034467810659646325
1179.21146953405 -0.02298955392732127
1259.498207885305 -0.017141392034341507
1398.327359617683 0
1498.6857825567506 0.00039648555206683866]

z0 = [-3.345280764635605 -2.300891563844747
18.399044205495798 -2.051911853332064
45.16129032258072 -1.7973813450904514
80.28673835125446 -1.5483487698374936
107.0489844683394 -1.3823138368171195
153.8829151732377 -1.1442969518190755
232.49701314217455 -0.8674376989035855
304.4205495818401 -0.6846314270307989
384.70728793309394 -0.534977955403305
470.0119474313025 -0.41849050020617273
570.3703703703701 -0.3185364925302121
715.8900836320195 -0.21840406635582177
889.8446833930701 -0.14581416986498352
1100.5973715651132 -0.07860986878971543
1227.7180406212663 -0.06151473340311542
1349.8207885304655 -0.03890844884279021
1463.5603345280765 -0.027397151647793994
1498.6857825567504 -0.027258381704570844]

z0_p = [-1.6726403823177822 -2.3008849557522124
56.86977299880513 -1.7530873008320906
90.32258064516111 -1.5372471743796323
127.1206690561528 -1.3490486989987418
180.6451612903223 -1.1441912223385244
227.47909199522124 -0.978076992207737
294.38470728793317 -0.7842285977098993
346.236559139785 -0.6568113574608005
393.0704898446836 -0.5515378352946154
443.24970131421736 -0.47390596419999786
503.464755077658 -0.3962344445501742
565.3524492234168 -0.32408729025914296
640.6212664277181 -0.2629492181304909
734.2891278375151 -0.21280040388661536
824.6117084826762 -0.173726752730464
916.606929510155 -0.14017746693310507
1020.3106332138591 -0.10658192448800508
1149.1039426523291 -0.07841823410621629
1232.7359617682198 -0.06702588257683928
1326.4038231780166 -0.05006290904092836
1420.0716845878137 -0.0386309089563448
1498.6857825567504 -0.027258381704570844]

z1 = [-1.6726403823178506 -1.9192477876106193
38.4707287933094 -1.6867883084340405
88.64994026284371 -1.4432272337996
128.79330943847063 -1.2660774891362958
204.06212664277146 -0.9947624258572016
260.93189964157733 -0.834139520622535
344.56391875746687 -0.656817965553335
419.83273596176787 -0.5182462651060993
535.2449223416967 -0.36845402353538237
635.6033452807642 -0.2795619627620769
786.1409796893669 -0.1904716592127378
889.8446833930701 -0.14581416986498352
1048.7455197132613 -0.09540764001226476
1165.8303464755072 -0.0728211797295435
1287.9330943847071 -0.050214895169220064
1366.5471923536445 -0.03884236791744655
1461.8876941457588 -0.027403759740328493
1498.6857825567504 -0.027258381704570844]

z1_p = [-1.6726403823178277 -1.913716814159292
81.95937873357217 -1.5206872944883219
123.7753882915174 -1.3601238620864655
172.28195937873372 -1.1940030238631436
230.82437275985646 -1.0112496167306328
275.98566308243704 -0.8783278354003445
341.2186379928315 -0.7066099428003507
426.52329749103905 -0.534812753089944
560.3345280764636 -0.3628239286960384
699.1636798088414 -0.25718696144045916
806.2126642771802 -0.1959233355536525
888.1720430107528 -0.16794467176282746
1037.0370370370367 -0.11204681701398833
1125.6869772998805 -0.0895726943043531
1279.5698924731184 -0.05577890908321992
1374.9103942652332 -0.044340300906101415
1498.6857825567504 -0.027258381704570844]

z5 = [-1.672640382317913 -1.1615044247787607
38.470728793309206 -0.923513972150855
90.32258064516107 -0.6854772628752073
170.60931899641565 -0.40861140186718226
296.0573476702505 -0.18134588342267488
396.41577060931877 -0.08692284919804205
495.1015531660694 -0.031223237225236122
662.3655913978496 0.008154386187499973
812.9032258064516 0.01981106141825606
975.1493428912789 0.020452046394095813
1087.216248506571 0.020894788593903257
1202.6284348864995 0.0213507469787797
1279.5698924731184 0.021654719235363995
1376.5830346475504 0.02203798860236139
1497.0131421744331 0.02251377126484133]

z5_p = [-8.12686079174238e-17 -1.155966843234899
41.8160095579449 -0.9069078356118034
85.30465949820785 -0.713151954409448
150.5376344086022 -0.5193101680041443
200.7168458781362 -0.3974305092989079
254.2413381123059 -0.2810686078599294
356.27240143369175 -0.13686020448081537
459.9761051373954 -0.05348590097376826
638.9486260454004 -0.003000074010635956
756.0334528076461 0.014055412820757063
911.5890083632016 0.020200938877787067
1032.0191158900836 0.020676721540267007
1264.516129032258 0.02159524640255528
1440.1433691756274 0.02228909611867058
1500.3584229390676 0.02252698744991033]

z2 = [1.625372158348476e-16 -0.9513208255357839
70.25089605734746 -0.7463972679502222
199.0442054958184 -0.46380879880737114
314.4563918757465 -0.2974236368826717
488.4109916367981 -0.1529310855245769
692.4731182795696 -0.0691602964654634
817.9211469534051 -0.04654079572007053
958.4229390681003 -0.02386182214186805
1088.888888888889 -0.012284444021526841
1210.9916367980888 -0.011802053266512846
1302.9868578255678 -0.0003766612744633413
1400.0000000000002 0.005537581543861858
1497.0131421744322 0.005920850910859254]

z2_p = [0 -0.9457898520844563
80.28673835125447 -0.7408266459436883
199.04420549581818 -0.5135875598693185
277.6583034647554 -0.3805336166883415
372.99880525686973 -0.2584755394846745
568.6977299880526 -0.12495902982628637
756.0334528076459 -0.06890918894915465
898.207885304659 -0.040692633827089875
1023.655913978494 -0.029135079984352164
1162.4850657108718 -0.0064627144986837415
1343.1302270011954 0.005312906397689776
1500.3584229390683 0.005934067095928253]

z3 = [-1.6726403823180234 -0.22123893805309702
48.50657108721606 0.061038950740634146
122.10274790919902 0.28809961831657516
267.6224611708477 0.4435417790042395
389.72520908004776 0.4440241697592535
501.79211469534 0.4002191243484421
625.5675029868584 0.34539838868271655
797.8494623655913 0.26311442044385247
958.4229390681003 0.19737711591122986
1152.4492234169657 0.13730294668062326
1381.600955794504 0.093960467747221
1498.6857825567502 0.0778301138706512]

z3_p = [-1.625372158348476e-16 -0.20463940960658045
58.542413381123204 0.1108573603577887
138.82915173237768 0.32135153994988475
214.09796893667854 0.4212064262378279
307.7658303464751 0.46582426703037605
419.8327359617684 0.45520506232752833
500.1194743130225 0.42233641006121747
612.1863799283153 0.3674694177477513
692.4731182795699 0.3346007654814387
779.450418160096 0.29069659868261066
884.8267622461173 0.2468651209016608
1000.2389486260455 0.20307329167591792
1177.5388291517327 0.14293304151996677
1351.4934289127839 0.10490346898425607
1498.6857825567502 0.083361087321979]


# standard methods

y0 = [1.426533523537671 -0.4125269978401729
63.05278174037082 -0.3099352051835853
141.7974322396575 -0.24514038876889832
232.52496433666175 -0.2505399568034561
290.72753209700426 -0.29373650107991356
369.47218259629096 -0.3801295896328294
443.08131241084163 -0.4773218142548592
504.7075606276747 -0.5745140388768897
593.7232524964336 -0.7041036717062632
684.4507845934379 -0.8174946004319652
792.2967189728957 -0.9254859611231099
879.6005706134094 -0.9848812095032398
987.4465049928673 -1.0172786177105828
1098.7161198288159 -1.0172786177105837
1199.7146932952926 -0.9794816414686822
1293.8659058487872 -0.9254859611231099
1376.034236804565 -0.8660907127429804
1499.2867332382311 -0.7634989200863929]

y0_p = [-0.28530670470769337 -0.4071274298056151
57.91726105563481 -0.22354211663066947
92.15406562054203 -0.056155507559395135
121.25534950071328 0.1058315334773221
157.20399429386578 0.3110151187904968
206.84736091298143 0.5053995680345573
289.01569186875884 0.47840172786177115
242.79600570613405 0.5539956803455723
314.6932952924393 0.3812095032397407
350.641940085592 0.2084233261339099
383.16690442225394 0.02483801295896315
412.2681883024251 -0.11015118790496747
444.7931526390869 -0.26133909287256984
482.4536376604849 -0.4017278617710578
528.6733238231097 -0.531317494600432
634.8074179743224 -0.7257019438444923
799.1440798858773 -0.8120950323974079
941.2268188302423 -0.8066954643628512
1001.1412268188302 -0.8174946004319654
1134.6647646219685 -0.9200863930885526
1233.9514978601997 -1.0550755939524836
1334.9500713266762 -1.1900647948164145
1429.1012838801712 -1.298056155507559
1497.5748930099858 -1.368250539956803]

y1 = [3.1383737517830923 -0.3153347732181424
194.86447931526382 -0.14794816414686807
360.91298145506425 -0.04535637149028071
598.8587731811696 0.07343412526997861
862.4821683309556 0.21922246220302366
1052.496433666191 0.34341252699783986
1256.2054208273892 0.5053995680345573
1417.1184022824536 0.6403887688984886
1497.5748930099858 0.7159827213822894]

y1_p = [-0.2853067047076081 -0.3153347732181424
49.35805991440796 -0.23434125269978434
121.25534950071322 -0.01835853131749432
169.18687589158336 0.17062634989200864
230.81312410841645 0.321814254859611
285.5920114122681 0.31641468682505414
347.2182596291012 0.21382289416846634
424.2510699001425 0.1058315334773221
499.5720399429386 0.05723542116630709
581.7403708987159 0.057235421166306644
725.5349500713266 0.11123110151187898
814.5506419400855 0.1706263498920082
920.6847360912979 0.24622030237580983
1033.666191155492 0.3110151187904968
1120.9700427960056 0.33261339092872566
1242.5106990014265 0.3326133909287248
1343.509272467903 0.3272138228941688
1468.4736091298146 0.3326133909287261
1497.5748930099858 0.338012958963283]

y2 = [1.4265335235376142 -0.09935205183585305
88.73038516405131 -0.029157667386609187
203.42368045649064 -0.0075593952483801186
355.777460770328 -0.002159827213822796
525.2496433666188 -0.01295896328293722
677.6034236804564 0.019438444924406273
826.533523537803 0.08963282937365058
1033.666191155492 0.2678185745140391
1208.2738944365192 0.46760259179265695
1386.3052781740369 0.710583153347732
1499.2867332382311 0.8833693304535637]

y2_p = [-0.28530670470752284 -0.09395248380129595
44.22253922967184 -0.029157667386608965
107.56062767475034 0.18142548596112285
150.3566333808843 0.36501079913606915
193.15263908701837 0.5269978401727862
235.94864479315257 0.5809935205183594
285.59201141226816 0.4946004319654427
326.6761768901569 0.34881209503239763
354.0656205420827 0.24082073434125295
401.99714693295283 0.06803455723542129
455.0641940085592 -0.056155507559395135
538.9443651925822 -0.061555075593952235
621.1126961483594 -0.01295896328293722
742.6533523537802 0.06803455723542129
867.6176890156917 0.14902807775377935
965.1925820256774 0.21922246220302366
1085.021398002853 0.3164146868250537
1182.5962910128387 0.4082073434125264
1276.7475035663335 0.5053995680345578
1384.5934379457917 0.6241900647948171
1456.490727532097 0.7051835853131747
1497.5748930099858 0.7483801295896328]

y3 = [-0.2853067047077218 -0.07235421166306688
64.7646219686161 -0.0723542116630671
148.64479315263895 -0.07235421166306688
294.1512125534949 -0.11015118790496747
410.5563480741796 -0.14254859611231052
559.4864479315265 -0.18034557235421134
742.6533523537802 -0.16954643628509714
958.3452211126959 -0.07235421166306644
1114.1226818830241 0.06263498920086308
1227.1041369472182 0.2030237580993517
1346.9329529243935 0.37580993520518335
1444.5078459343795 0.5377969762419008
1500.9985734664765 0.645788336933045]

y3_p = [-0.2853067047076081 -0.06695464362850934
129.81455064194003 -0.018358531317494542
232.5249643366617 0.07343412526997861
304.4222539229671 0.10043196544276434
398.57346647646216 0.04643628509719244
456.7760342368045 -0.029157667386608743
518.4022824536376 -0.09935205183585305
585.1640513552068 -0.1479481641468683
682.7389443651923 -0.1641468682505396
768.3309557774605 -0.13174946004319654
896.7189728958629 -0.06155507559395246
1026.8188302425106 0.03023758099352092
1156.9186875891583 0.08423326133909281
1278.4593437945791 0.07883369330453505
1408.5592011412268 0.07343412526997861
1492.4393723252497 0.08963282937365058]

y5 = [1.426533523537671 0.05183585313174932
114.40798858773168 -0.1155507559395248
244.50784593437942 -0.2073434125269975
458.48787446504986 -0.18034557235421178
643.3666191155493 -0.09935205183585305
828.2453637660484 -0.012958963282936997
1025.1069900142652 0.041036717062634676
1249.358059914408 0.05183585313174932
1461.6262482168331 0.01943844492440583
1499.286733238231 0.01403887688984895]

y5_p = [-1.997146932952944 0.05723542116630709
88.73038516405131 -0.1911447084233262
133.23823109843076 -0.3477321814254859
170.8987161198288 -0.4719222462203021
241.0841654778887 -0.5691144708423326
333.5235378031383 -0.46112311015118745
434.52211126961475 -0.25593952483801274
540.6562054208273 -0.126349892008639
626.2482168330954 -0.050755939524838034
744.3651925820257 -0.018358531317494542
881.3124108416547 -0.012958963282937441
1038.801711840228 0.008639308855291183
1165.477888730385 0.07883369330453593
1290.442225392297 0.18682505399568017
1379.4579172610559 0.26241900647948135
1494.151212553495 0.34341252699783986]

y4 = [3.138373751783007 0.6403887688984877
104.13694721825952 0.5971922246220305
254.77888730385152 0.4136069114470837
401.9971469329529 0.1166306695464363
580.0285306704707 -0.32613390928725683
763.1954350927247 -0.7742980561555077
946.3623395149787 -1.2278617710583153
1184.308131241084 -1.773218142548596
1427.3894436519256 -2.3239740820734354
1497.5748930099858 -2.48596112311015]

y4_p = [1.4265335235377563 0.6349892008639313
100.71326676176872 0.5107991360691151
193.15263908701849 0.21382289416846634
285.59201141226805 0.08423326133909281
381.4550641940085 0.1058315334773221
453.3523537803137 0.019438444924406273
504.70756062767475 -0.10475161987041015
564.6219686162624 -0.26673866090712717
650.2139800285306 -0.466522678185745
716.9757489300999 -0.6069114470842334
800.8559201141227 -0.7688984881209502
881.3124108416549 -0.9308855291576672
1033.666191155492 -1.260259179265659
1170.6134094151212 -1.546436285097192
1326.3908701854493 -1.8596112311015112
1499.286733238231 -2.210583153347734]

# define spline function
spline = z->t->FM.akima(z[:,1], z[:,2], t*1500) 

# create method of charactersitics splines
z0s = spline(z0)
z0ps = spline(z0_p)
z1s = spline(z1)
z1ps = spline(z1_p)
z2s = spline(z2)
z2ps = spline(z2_p)
z3s = spline(z3)
z3ps = spline(z3_p)
z4s = spline(z4)
z4ps = spline(z4_p)
z5s = spline(z5)
z5ps = spline(z5_p)

# create standard method splines
y0s = spline(y0)
y0ps = spline(y0_p)
y1s = spline(y1)
y1ps = spline(y1_p)
y2s = spline(y2)
y2ps = spline(y2_p)
y3s = spline(y3)
y3ps = spline(y3_p)
y4s = spline(y4)
y4ps = spline(y4_p)
y5s = spline(y5)
y5ps = spline(y5_p)

# discretize time
t = range(0.0, 1.0, 1000)

# allocate data
z = zeros(6, length(t))
zp = zeros(6, length(t))
y = zeros(6, length(t))
yp = zeros(6, length(t))

# fill in method of characteristics data
z[1,:] = z0s.(t)
zp[1,:] = z0ps.(t)
z[2,:] = z1s.(t)
zp[2,:] = z1ps.(t)
z[3,:] = z2s.(t)
zp[3,:] = z2ps.(t)
z[4,:] = z3s.(t)
zp[4,:] = z3ps.(t)
z[5,:] = z4s.(t)
zp[5,:] = z4ps.(t)
z[6,:] = z5s.(t)
zp[6,:] = z5ps.(t)

# fill in standard method data
y[1,:] = y0s.(t)
yp[1,:] = y0ps.(t)
y[2,:] = y1s.(t)
yp[2,:] = y1ps.(t)
y[3,:] = y2s.(t)
yp[3,:] = y2ps.(t)
y[4,:] = y3s.(t)
yp[4,:] = y3ps.(t)
y[5,:] = y4s.(t)
yp[5,:] = y4ps.(t)
y[6,:] = y5s.(t)
yp[6,:] = y5ps.(t)

# store data
H5.h5write("/Users/atagg/Documents/research/prospectus/data/z.h5", "z", z)
H5.h5write("/Users/atagg/Documents/research/prospectus/data/zp.h5", "zp", zp)
H5.h5write("/Users/atagg/Documents/research/prospectus/data/y.h5", "y", y)
H5.h5write("/Users/atagg/Documents/research/prospectus/data/yp.h5", "yp", yp)
